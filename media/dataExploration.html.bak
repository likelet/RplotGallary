<!doctype html>

<html lang="en">
<head>
    <title>Data Exploration</title>
</head>
<body>
    <h1>Data Exploration Report</h1>
        <p>
            IDEA: Interactive Differential Expression Analyzer
            <br />
            <strong>@DATE</strong>
        </p>
        <br /><br />
        
        
<!--Parameter Info:
    Parameters:
        Parameters, as digits or characters, etc. that are supposed to be introduced are tagged as follows and can be located by searching following tags.
        "Parameter"                         |"Tag"
        --------------------------------------------------------
        current system data                 |@DATE
        experimental design                 |@experimentalDesign
        normalization method                |@normMethod
        Spearman correlation coefficient    |@Spearman
        Feature1 in Correlation Analysis    |@feature1
        Feature2 in Correlation Analysis    |@feature2
        feature name in Feature Query       |@FEATURE
    Images - Plots:
        Plots are supposed to be insert by <img src="plotFileName" alt="plotName">,
        with NO suffix set in plotFileName.
        Plots and their corresponding plotFileName are tagged as follows.
        "Plots"             |"plotFileName"
        ------------------------------------------
        Sample Boxplot      |dataExpBoxplot
        Stacked Density Plot|dataExpStackedDensity
        Ratio Bar Plot      |dataExpRationBar
        Heat Map            |dataExpHeatMap
        PCA                 |dataExpPCA
        Correlation Analysis|dataExpCorrelation
        Feature Query       |dataExpFeatureQuery
    Images - Formulas:
        Formulas were inserted via LaTex in Rmarkdown files. Here Formulas are supposed to be inserted via image. Formula id, LaTex coding and inserted images are defineds as follows.
        "Formula id"
            "LaTex coding"
            "Inserted images"
        Sample Disntance
            $$Sample\ Distance = d(q,p) = \sqrt{\sum_{i=1}^{n} (q_{i}-p_{i})^{2}}$$
            <img src="dataExpFormSampleDistance" alt="Sample Distance Formula">
        x- and y-coordinates calculation in Correlation Analysis
            $$log_{10} (Normalized Read Counts + 1)$$
            <img src="dataExpFormCorrelationCoord" alt="x- and y-axis in Correlation Analysis">
        Spearman Correlation Coefficient in Correlation Analysis
            $$Spearman\ Correlation\ Coefficient = \frac{\Sigma_{i}(P_{i}-\overline{P})(Q_{i}-\overline{Q})}{\sqrt{\Sigma_{i}(P_{i}-\overline{P})(Q_{i}-\overline{Q})}}$$
            <img src="dataExpFormCorrelationSpearman" alt="Spearman Coefficient">
        p
            $p$
            <img src="dataExpFormP" alt="p">
        q
            $q$
            <img src="dataExpFormQ" alt="q">
        Pi
            $P_{i}$
            <img src="dataExpFormPi" alt="P_{i}">
        Qi
            $Q_{i}$
            <img src="dataExpFormQi" alt="Q_{i}">
        pi
            $p_{i}$
            <img src="dataExpFormpi" alt="p_{i}">
        qi
            $q_{i}$
            <img src="dataExpFormqi" alt="q_{i}">
        P-bar
            $\overline{P}$
            <img src="dataExpFormPbar" alt="overline{P}">
        Q-bar
            $\overline{Q}$
            <img src="dataExpFormQbar" alt="overline{Q}">-->

    <p>
        This is an R Markdown document for Data Exploration of <a href="http://idea.biocuckoo.org">IDEA: Interactive Differential Expression Analyzer</a>. Plots in Data Exploration module (plotted in R[<a href="#ref1">1</a>] with ggplot2[<a href="#ref2">2</a>] (for all plots but heat map) and pheatmap[<a href="#ref3">3</a>] (for heat map)) is presented in HTML file via rmarkdown [<a href="#ref4">4</a>]. For figures of higher resolution, please download from website directly.
    </p>
    <p>
        Citation: This work is in process of publishing, citation method will be post here as soon as possible. Check out the IDEA website above.
    </p>
    <h2>
        Introdution
    </h2>
        <p>
            Count data, as generated by various high-throughput sequencing methods such as RNA-Seq[<a href="#ref5">5</a>, <a href="#ref6">6</a>], Tag-Seq[<a href="#ref7">7</a>, <a href="#ref8">8</a>], and ChIP-Seq[<a href="#ref9">9</a>], has been more and more used to represent the abundance of genes/features at RNA/DNA level since read count and abundance are linearly related [<a href="#ref6">6</a>]. Also in RNA-Seq, variation caused by replicate is low, which makes RNA-Seq count data advantageous for differential expressed gene discovery[<a href="#ref10">10</a>]. Differential expression (DE) analysis typically works with following questions: choice of normalization and noise control method [<a href="#ref6">6</a>, <a href="#ref8">8</a>]; choice of data distribution given numbers of replicates[<a href="#ref8">8</a>]; choice of assessment of statistical significance of DE detection[<a href="#ref11">11</a>].
        </p>
        <p>
            Counts data depends not only on expression level of features, but also on several factors including transcript length and sequence depth [<a href="#ref6">6</a>, <a href="#ref12">12</a>]. Therefore, it is necessary to normalize counts data before identifying differential expressed features.
        </p>
    <h2>
        Basic Information
    </h2>
        <h3>
            Inputted Data
        </h3>
            <p>
                Raw read count data should be uploaded in the "New" module, with experimental design type related parameters declared.
            </p>
            <p>
                Note that due to an upper limits for number of groups in color palettes, only data that has no more than 11 conditions/samples is supported. To plot data with more conditions/samples, please refer to open-sourced code of IDEA and run locally.
            </p>
        <h3>
            Experimental Design
        </h3>
            <p>
                In data exploration, experimental design is set in the "New" module before starting analysis. Three experiment types are available, including Standard Comparison, Multi-factor Design and Without Replicates. Selection of paired conditions is available for all three experiment types. For Multi-factor Design, factor of interst is defined as first column of inputted data.
            </p>
            <p>
                In this case, experimental design type was stated as <strong>@experimentalDesign</strong>.
            </p>
        <h3>
            Normalization
        </h3>
            <p>
                For normalization, four methods are provided, including the Reads per Kilobase per Million Reads (RPKM) [<a href="#ref6">6</a>], the Upper Quartile (UQ) [<a href="#ref13">13</a>], and the Trimmed Mean of M values (TMM) [<a href="#ref14">14</a>]. User can also perform data exploration without any normalization method by choosing "None" in the drop-down menu in Normalization Method Panel. Summarized details of each normalization methods are listed in Table 1. In this report the "normalized counts" is taken as the expression unit, but inputted count data can be normalized, or not, as decided by users.
            </p>
            <p>
                <em>Note that if user did not upload a gene length file for normalization, a default length of 1000bp/gene is used.</em>
            </p>
            <p>
                In this case, normalization method was set as <strong>@normMethod</strong>.
            </p>
                <div align="center">
                    Table 1: Summarized details for normalization methods provided in Data Exploration module<br/>
                    <table cellpadding="5" cellspacing="0" border="1" frame=hsides rules=all style="border-color: #000000">
                        <tr>
                            <td style="border-width: medium thin medium 0">&nbsp;Method</td>
                            <td style="border-width: medium thin medium 0">&nbsp;Abbreviation</td>
                            <td style="border-width: medium thin medium 0">&nbsp;Summary</td>
                        </tr>
                        <tr>
                            <td style="border-width: 0 thin thin 0">&nbsp;The Reads per Kilobase per Million Reads[<a href="#ref6">6</a>]</td>
                            <td style="border-width: 0 thin thin 0">&nbsp;RPKM</td>
                            <td style="border-width: 0 thin thin 0">&nbsp;Counts per kilobase per million mapped reads or total number of reads in library calculated</td>
                        </tr>
                        <tr>
                            <td style="border-width: 0 thin thin 0">&nbsp;The Upper Quartile (default)[<a href="#ref13">13</a>]</td>
                            <td style="border-width: 0 thin thin 0">&nbsp;UQ</td>
                            <td style="border-width: 0 thin thin 0">&nbsp;Features that are zero in all library removed, scale factor calculated from a upper quartile of counts for each library</td>
                        </tr>
                        <tr>
                            <td style="border-width: 0 thin thin 0">&nbsp;The Trimmed Mean of M values[<a href="#ref14">14</a>]</td>
                            <td style="border-width: 0 thin thin 0">&nbsp;TMM</td>
                            <td style="border-width: 0 thin thin 0">&nbsp;Weight taken from delta method on binomial data, then trimmed weighted means calculated</td>
                        </tr>
                        <tr>
                            <td style="border-width: 0 thin medium 0">&nbsp;None</td>
                            <td style="border-width: 0 thin medium 0">&nbsp;None</td>
                            <td style="border-width: 0 thin medium 0">&nbsp;All scaling factors set to 1</td>
                        </tr>
                    </table>
                </div>
    <h2>
        Data Exploration Plots
    </h2>
        <h3>
            Samples Boxplot
        </h3>
            <p>
                Samples boxplot visualizes count distribution for all samples, showing reads distribution in each sample repectively. It uses expression values as y-axis, and samples as x-axis.  
            </p>
            <div align="center">
                <img src="dataExpBoxplot" alt="Sample Boxplot">
                <br />
                Figure 1: Expression distribution of in all samples.  
            </div>
        <h3>
            Stacked Density Plot
        </h3>
            <p>
                Stacked density plot visualizes density distribution of genes with different reads count, showing overall condition of normailzed counts. It also enables interactive comparison of density distribution between groups. The x-axis is defined as logarithmic scale (base 10) of (normalized reads count + 1) to avoid NA values, and the y-axis is defined as density of calculated logarithm.
            </p>
            <div align="center">
                <img src="dataExpStackedDensity" alt="Stacked Density Plot">
                <br />
                Figure 2: Normalized expression level distribution for genes in selected samples.  
            </div>
        <h3>
            Ratio Bar Plot
        </h3>
            <p>
                Ratio bar plot visualize distribution of normalized counts in each sample using stacked bar. Low counts may introduce noise and interfere extraction of differential expression of features [<a href="#ref13">13</a>]. It shows features in each sample by feature of having non-zero normalized counts, or more than 1, 2, 5, 10, and uses samples as x-axis, sensitivity, that is, proportion of groups in each sample, as y-axis.
            </p>
            <div align="center">
                <img src="dataExpRationBar" alt="Ratio Bar Plot">
                <br />
                Figure 3: Ratio of genes with low counts for each sample.  
            </div>
        <h3>
            Heat Map of Sample Distance
        </h3>
            <p>
                Heat map of sample distance visualizes the distance between samples by calculating sample distance from features in two samples and plotting heatmap and hierarchical clustering. Sample distances is defined as Euclidean distance between samples, calculated as:
            </p>
            <p>
                <img src="dataExpFormSampleDistance" alt="Sample Distance Formula">
            </p>
            <p>
                , where p and q represent the two samples, pi and qi their features’ normalized counts.
            </p>
            <div align="center">
                <img src="dataExpHeatMap" alt="Heat Map">
                <br />
                Figure4 Heat map of sample distance.
            </div>
        <h3>
            PCA
        </h3>
            <p>
                Principal Component Analysis (PCA) result is visualized by scatter plot showing samples as dots colored by their groups/conditions. Basically, PCA is to reduce dimension of data. Here a 2-dimension eigenvector is generated using package FactoMineR [<a href="#ref15">15</a>]. In IDEA, the first two principal components were extracted to generate this two-dimension plot. X- and y-axis represent s first two principal components.
            </p>
            <div align="center">
                <img src="dataExpPCA" alt="PCA">
                <br />
                Figure5 PCA result.  
            </div>
        <h3>
            Correlation Analysis
        </h3>
            <p>
                Correlation analysis visualizes feature expression correlation between two selected samples using scatter plot. Generally, samples from biological/technical replicates are likely display high correlation, and samples from different conditions in experimental design usually gives a poor correlation [<a href="#ref16">16</a>]. Thus examining correlation between samples can give a hint of their relationship. To avoid NA, x-axis and y-axis are defined as:
                <br />
                <img src="dataExpFormCorrelationCoord" alt="x- and y-axis in Correlation Analysis">
                , where "Normalized Reads Count" stands for normalized counts. Spearman’s correlation is calculated by function <em>cor</em> in package stats [<a href="#ref1">1</a>]. Each feature is visualized as a single black dot in figure. For selected two samples, Spearman correlation coefficient is calculated as:
                <br />
                <img src="dataExpFormCorrelationSpearman" alt="Spearman Coefficient">
                , where <img src="dataExpFormP" alt="p"> and <img src="dataExpFormQ" alt="q"> stand for the two samples, <img src="dataExpFormPi" alt="P_{i}"> and <img src="dataExpFormQi" alt="Q_{i}"> represent converted ranks of <img src="dataExpFormpi" alt="p_{i}"> and <img src="dataExpFormqi" alt="q_{i}">, and <img src="dataExpFormPbar" alt="overline{P}"> and <img src="dataExpFormQbar" alt="overline{Q}"> the average value of <img src="dataExpFormPi" alt="P_{i}"> and <img src="dataExpFormQi" alt="Q_{i}">.
            </p>
            <p>
                Spearman correlation coefficient is shown as digits on webpage in module of correlation analysis. In this case, Spearman correlation coefficient is <strong>@Spearman</strong>.
            </p>
            <div align="center">
                <img src="dataExpCorrelation" alt="Correlation Analysis">
                <br />
                Figure 6: Scatter plot and correlation analysis between gene expression levels in <strong>@feature1</strong> and <strong>@feature2</strong>.
            </div>
        <h3>
            Feature Query - Expression Level Comparison
        </h3>
            <p>
                A histogram with error bar visualizes the comparison result of expression level of a certain feature, selected by user, in different conditions, where x-axis stands for applicable conditions and y-axis stands for normalized counts.
            </p>
            <div align="center">
                <img src="dataExpFeatureQuery" alt="Feature Query">
                <br />
                Figure 7: Expression level comparison of feature @FEATURE in each condition.  
            </div>
    <h2>
        References
    </h2>
        <p><a name="ref1">1.   </a>R Core Team, <em>R: A language and environment for statistical computing</em>, 2014, R Foundation for Statistical Computing: Vienna, Austria.</p>
        <p><a name="ref2">2.   </a>Wickham, H., <em>ggplot2: elegant graphics for data analysis</em>, 2009, Springer New York.</p>
        <p><a name="ref3">3.   </a>Kolde, R., pheatmap: Pretty Heatmaps, 2013.</p>
        <p><a name="ref4">4.   </a>JJ Allaire, J.M., Yihui Xie, Hadley Wickham, Joe Cheng and Jeff Allen, <em>rmarkdown: Dynamic Documents for R</em>, 2014.</p>
        <p><a name="ref5">5.   </a>Nagalakshmi, U., et al., <em>The transcriptional landscape of the yeast genome defined by RNA sequencing.</em> Science, 2008. <strong>320</strong>(5881): p. 1344-9.</p>
        <p><a name="ref6">6.   </a>Mortazavi, A., et al., <em>Mapping and quantifying mammalian transcriptomes by RNA-Seq.</em> Nat Methods, 2008. <strong>5</strong>(7): p. 621-8.</p>
        <p><a name="ref7">7.   </a>Morrissy, A.S., et al., <em>Next-generation tag sequencing for cancer gene expression profiling.</em> Genome Res, 2009. <strong>19</strong>(10): p. 1825-35.</p>
        <p><a name="ref8">8.   </a>Anders, S. and W. Huber, <em>Differential expression analysis for sequence count data.</em> Genome biol, 2010. <strong>11</strong>(10): p. R106.</p>
        <p><a name="ref9">9.   </a>Robertson, G., et al., <em>Genome-wide profiles of STAT1 DNA association using chromatin immunoprecipitation and massively parallel sequencing.</em> Nat Methods, 2007. <strong>4</strong>(8): p. 651-7.</p>
        <p><a name="ref10">10. </a>Marioni, J.C., et al., <em>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays.</em> Genome Res, 2008. <strong>18</strong>(9): p. 1509-17.</p>
        <p><a name="ref11">11. </a>Robinson, M.D., D.J. McCarthy, and G.K. Smyth, <em>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data.</em> Bioinformatics, 2010. <strong>26</strong>(1): p. 139-40.</p>
        <p><a name="ref12">12. </a>Li, J., et al., <em>Normalization, testing, and false discovery rate estimation for RNA-sequencing data.</em> Biostatistics, 2011: p. kxr031.</p>
        <p><a name="ref13">13. </a>Bullard, J.H., et al., <em>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments.</em> BMC Bioinformatics, 2010. <strong>11</strong>: p. 94.</p>
        <p><a name="ref14">14. </a>Robinson, M.D. and A. Oshlack, <em>A scaling normalization method for differential expression analysis of RNA-seq data.</em> Genome Biol, 2010. <strong>11</strong>(3): p. R25.</p>
        <p><a name="ref15">15. </a>Francois Husson, J.J., Sebastien Le and Jeremy Mazet, <em>FactoMineR: Multivariate Exploratory Data Analysis and Data Mining with R</em>, 2014.</p>
        <p><a name="ref16">16. </a>Fu, X., et al., <em>Estimating accuracy of RNA-Seq and microarrays with proteomics.</em> BMC Genomics, 2009. <strong>10</strong>: p. 161.</p>

</body>
</html>
